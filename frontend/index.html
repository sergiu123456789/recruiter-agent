<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sergiu â€“ AI/ML Portfolio Guided Tour</title>

  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: radial-gradient(circle at 20% 20%, #0d1117 0%, #0b0f14 45%, #06080a 100%);
      color: #e6e6e6;
    }

    header {
      padding: 32px 24px;
      border-bottom: 1px solid rgba(255,255,255,0.08);
      background: rgba(255,255,255,0.02);
      backdrop-filter: blur(6px);
    }

    a { color: #7cb7ff; text-decoration: none; }

    .wrap { max-width: 900px; margin: 0 auto; padding: 32px 24px; }

    .pill {
      display:inline-block;
      padding:6px 12px;
      border:1px solid rgba(255,255,255,0.18);
      border-radius:999px;
      margin-right:6px;
      font-size:12px;
      background: rgba(255,255,255,0.05);
    }

    h1, h2 { color: #fff; }

    ul li { margin-bottom: 12px; line-height: 1.5; }

    /* Chat widget */
    .chat-launch {
      position: fixed;
      right: 20px;
      bottom: 20px;
      border: 0;
      padding: 12px 16px;
      border-radius: 999px;
      cursor: pointer;
      background: #0ea5e9;
      color: #fff;
      font-weight: 600;
      box-shadow: 0 4px 20px rgba(0,0,0,.6);
    }

    .widget {
      position: fixed;
      right: 20px;
      bottom: 80px;
      width: 360px;
      height: 520px;
      border: 1px solid rgba(255,255,255,0.15);
      border-radius: 16px;
      background: rgba(24, 27, 33, 0.95);
      display: none;
      box-shadow: 0 10px 40px rgba(0,0,0,.6);
      backdrop-filter: blur(8px);
      color: #e6e6e6;
    }

    .widget header {
      border-bottom: 1px solid rgba(255,255,255,0.08);
      padding: 12px 16px;
      font-weight: 600;
      color: #fff;
    }

    .widget .messages {
      height: 400px;
      overflow-y: auto;
      padding: 12px 16px;
      font-size: 14px;
    }

    .widget .input {
      display: flex;
      border-top: 1px solid rgba(255,255,255,0.08);
    }

    .widget .input input {
      flex: 1;
      padding: 12px;
      border: 0;
      background: rgba(255,255,255,0.05);
      color: #fff;
    }

    .widget .input button {
      border: 0;
      padding: 0 16px;
      cursor: pointer;
      background: #0ea5e9;
      color: #fff;
    }

    .msg { margin: 8px 0; }
    .msg.you { text-align: right; }

    .msg .bubble {
      display: inline-block;
      padding: 10px 12px;
      border-radius: 12px;
      max-width: 85%;
    }

    .msg.you .bubble { background: #0f2036; color:#cfe2ff; }
    .msg.ai  .bubble { background: #1e242d; color:#e6e6e6; }
  </style>
</head>

<body>
  <header class="wrap">
    <h1>Sergiu</h1>
    <p>
      AI/ML Engineer â€¢ Software Developer â€¢
      <a href="https://github.com/sergiu123456789">GitHub</a> â€¢
      <a href="https://www.linkedin.com/in/sergiu-nicoara-31b27013/">LinkedIn</a>
    </p>
    <p>
      This page hosts my <strong>AI-powered recruiter tour agent</strong>.<br/>
      If youâ€™re coming from GitHub or LinkedIn, the tour auto-starts and
      <strong>matches your open role to my projects, skills & impact.</strong>
    </p>

    <div>
      <span class="pill">Machine Learning Engineering</span>
      <span class="pill">LLM Agents & Automations</span>
      <span class="pill">Deep Learning & NLP</span>
      <span class="pill">MLOps & Deployment</span>
      <span class="pill">Cloud AI (AWS / OCI / GCP)</span>
    </div>
  </header>

  <main class="wrap">
    <h2>Highlighted Projects</h2>
    <ul>
      <li>
        <a href="https://github.com/sergiu123456789/Generative-AI/blob/main/%23%20Customized%20Chatbot%20with%20RAG.md">
          RAG Q&A Chatbot
        </a>
        â€” Retrieval-augmented generation pipeline with embeddings, vector search and FastAPI backend.
      </li>
      <li>
        <a href="https://github.com/sergiu123456789/Agentic-AI">
          AutoGen / LangGraph / CrewAI
        </a>
        â€” Multi-agent orchestration systems and workflows.
      </li>
      <li>
        <a href="https://github.com/sergiu123456789/Generative-AI/blob/main/Character%20AI%20Chatbot.md">
          Character AI Chatbot
        </a>
        â€” Persona-driven conversational agent.
      </li>
    </ul>
  </main>

  <!-- CHAT WIDGET -->
  <div id="widget" class="widget">
    <header>Recruiter Tour Agent</header>
    <div id="msgs" class="messages"></div>
    <div class="input">
      <input id="inp" placeholder="Paste a JD or ask about fit, impact, CVâ€¦" />
      <button id="send">Send</button>
    </div>
  </div>

  <button id="launch" class="chat-launch">ðŸ’¬ Chat with the AI tour</button>

<script>
document.addEventListener("DOMContentLoaded", function () {

  function initWhenReady() {
    const widget = document.getElementById("widget");
    const launch = document.getElementById("launch");
    const msgs   = document.getElementById("msgs");
    const inp    = document.getElementById("inp");
    const send   = document.getElementById("send");

    if (!widget || !launch || !msgs || !inp || !send) {
      return setTimeout(initWhenReady, 40);
    }

    // IMPORTANT: include /chat at the end
    const BACKEND_URL =
      "https://recruiter-agent-190861422358.europe-west1.run.app/chat";

    let sessionId  = localStorage.getItem("tourSessionId") || null;
    let agentState = null;  // <-- track serialized State from backend

    function detectSource() {
      const params = new URLSearchParams(location.search);
      const src = params.get("src");
      if (src === "github" || src === "linkedin") return src;

      const ref = document.referrer.toLowerCase();
      if (ref.includes("github.com"))   return "github";
      if (ref.includes("linkedin.com")) return "linkedin";

      return "direct";
    }

    function addMsg(cls, text) {
      const d = document.createElement("div");
      d.className = "msg " + cls;
      d.innerHTML = `<div class="bubble">${String(text).replace(/\n/g, "<br/>")}</div>`;
      msgs.appendChild(d);
      msgs.scrollTop = msgs.scrollHeight;
    }

    const addAI  = (t) => addMsg("ai", t);
    const addYou = (t) => addMsg("you", t);

    function showWidget(intro = true) {
      widget.style.display = "block";
      if (intro && !widget.dataset.opened) {
        widget.dataset.opened = "1";
        addAI(
          "ðŸ‘‹ Hi! Iâ€™m Sergiuâ€™s AI recruiter tour agent.\n\n" +
          "Paste a job description or tell me the role youâ€™re hiring for, " +
          "and Iâ€™ll highlight the most relevant projects, skills, and impact."
        );
      }
    }

    async function sendMessage(message) {
      const source = detectSource();

      const payload = {
        session_id: sessionId,
        message,
        source,
        state: agentState,  // <-- send previous state back
      };

      addAI("Thinkingâ€¦");

      try {
        const res = await fetch(BACKEND_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload),
        });

        if (msgs.lastChild && msgs.lastChild.innerText === "Thinkingâ€¦") {
          msgs.removeChild(msgs.lastChild);
        }

        if (!res.ok) {
          return addAI("âš ï¸ Something went wrong. Please try again.");
        }

        const data = await res.json();

        // Keep session & state for next turn
        if (data.session_id) {
          sessionId = data.session_id;
          localStorage.setItem("tourSessionId", sessionId);
        }
        if (data.state) {
          agentState = data.state;
        }

        addAI(data.reply);

      } catch (err) {
        if (msgs.lastChild && msgs.lastChild.innerText === "Thinkingâ€¦") {
          msgs.removeChild(msgs.lastChild);
        }
        addAI("âš ï¸ I couldn't reach the backend. Please try again.");
      }
    }

    send.onclick = () => {
      if (!inp.value.trim()) return;
      const msg = inp.value.trim();
      addYou(msg);
      sendMessage(msg);
      inp.value = "";
    };

    inp.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && inp.value.trim()) {
        const msg = inp.value.trim();
        addYou(msg);
        sendMessage(msg);
        inp.value = "";
      }
    });

    launch.onclick = () => showWidget();

    // Auto-open for recruiters
    (function autoOpen() {
      const ref = document.referrer.toLowerCase();
      const src = new URLSearchParams(location.search).get("src")?.toLowerCase();
      const isRecruiter =
        ref.includes("github.com") ||
        ref.includes("linkedin.com") ||
        src === "github" ||
        src === "linkedin";

      if (isRecruiter) {
        showWidget(true);
        sendMessage(
          "I'm a recruiter visiting from GitHub/LinkedIn. " +
          "Please show me the most relevant AI/ML projects and ATS summary."
        );
      }
    })();
  }

  initWhenReady();
});
</script>


</body>
</html>